<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Aykut C. Satici">
  <title>06_localization â€“ Robotics and Automated Systems</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-0ff6e4cdb96306cb119adac6e196fbc9.css">
  <link rel="stylesheet" href="styles.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="robotics-and-automated-systems" class="slide level2 center smaller">
<h2>Robotics and Automated Systems</h2>
<!-- ###################################################################### -->
<hr>
<h3 id="localization">Localization</h3>
<p><br></p>
<div class="columns">
<div class="column" style="width:55%;">
<p><strong>Instructor</strong>: Aykut Satici, Ph.D.&nbsp;<br></p>
<p>&nbsp;</p>
<ul>
<li>Mechanical and Biomedical Engineering <br></li>
<li>Electrical and Computer Engineering <br></li>
<li>Boise State University, Boise, ID, USA</li>
</ul>
</div><div class="column" style="width:45%;">
<p><strong>Topics</strong>: <br></p>
<ul>
<li>Dead Reckoning</li>
<li>Localizing with a Map</li>
<li>Creating a Map</li>
<li>Localization and Mapping</li>
<li>Pose Graph SLAM</li>
<li>Complementary filter</li>
</ul>
</div></div>
</section>
<section id="localization-1" class="slide level2 smaller">
<h2>Localization</h2>
<div class="columns">
<div class="column" style="width:85%;">
<ul>
<li>GPS makes outdoor localization easy; unfortunately GPS is far from perfect.
<ul>
<li>relies on very weak radio signals received from distant orbiting satellites.</li>
<li>GPS cannot work where there is no <em>line of sight</em> radio reception.</li>
</ul></li>
<li>GPS has only been in use since 1995 yet humankind has been navigating the planet and localizing for many thousands of years!</li>
<li><em>Dead reckoning</em> is the estimation of location based on estimated speed, direction and time of travel w.r.t. a previous estimate.</li>
</ul>
</div><div class="column" style="width:15%;">
<center>
<img src="contents/assets/localization.png" width="100%">
</center>
</div><div class="column" style="width:80%;">
<ul>
<li>Given average compass heading over the previous hour and a distance traveled the position at <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math> p.m. can be found using elementary geometry from the position at <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math> p.m.
<ul>
<li>Measurements on which the update is based are subject to both systematic and random error.</li>
<li>Modern instruments are quite precise but 500 years ago clocks, compasses and speed measurements were primitive.</li>
</ul></li>
</ul>
</div><div class="column" style="width:20%;">
<center>
<img src="contents/assets/fig6_1.svg" width="100%">
</center>
</div></div>
</section>
<section id="localization-2" class="slide level2 smaller">
<h2>Localization</h2>
<div class="columns">
<div class="column" style="width:80%;">
<ul>
<li>Estimates are recursive: each estimate is based on the previous one.
<ul>
<li>errors will accumulate over time</li>
<li>for sea voyages of many-years this approach was quite inadequate!</li>
</ul></li>
<li>The Phonecians were navigating at sea more than <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">4,000</annotation></semantics></math> years ago and they did not even have a compass!</li>
</ul>
</div><div class="column" style="width:20%;">
<center>
<img src="contents/assets/fig6_1.svg" width="200%">
</center>
</div><div class="column" style="width:50%;">
<ul>
<li>They navigated with crude dead reckoning but wherever possible they used <em>additional information</em> to correct their position estimate.
<ul>
<li>sightings of islands and headlands</li>
<li>primitive maps and observations of the Sun and the Pole Star.</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<center>
<img src="contents/assets/landmark.png" width="100%">
</center>
</div></div>
</section>
<section id="localization-3" class="slide level2 smaller">
<h2>Localization</h2>
<ul>
<li>A landmark is a visible feature in the environment whose location is known w.r.t. some coordinate frame.
<ul>
<li>A precise bearing measurement to two landmarks will therefore pinpoint our location, a process known as <em>resectioning</em>.</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:53%;">
<ul>
<li>This process is critically reliant on correctly associating the observed landmark with the feature on the map.
<ul>
<li>Mistaking one lighthouse for another, e.g.&nbsp;<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‚</mi><annotation encoding="application/x-tex">\bm{C}</annotation></semantics></math> for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\bm{B}</annotation></semantics></math> leads to significant error in estimated position (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğª</mi><annotation encoding="application/x-tex">\bm{q}</annotation></semantics></math> instead of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ©</mi><annotation encoding="application/x-tex">\bm{p}</annotation></semantics></math>).</li>
</ul></li>
<li>This is a very common error and countless ships have foundered because of this fundamental data association error.
<ul>
<li>This is why lighthouses flash with a <em>unique</em> flashing pattern!</li>
</ul></li>
</ul>
</div><div class="column" style="width:47%;">
<center>
<img src="contents/assets/landmark.png" width="100%">
</center>
</div></div>
</section>
<section id="localization-4" class="slide level2 smaller">
<h2>Localization</h2>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Localization Problem</strong></p>
</div>
<div class="callout-content">
<p>Find an estimate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{x}}</annotation></semantics></math> of the true, but unknown position, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math> of the robot. We also wish to know the <em>uncertainty</em> of the estimate (standard deviation associated with the position estimate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{x}}</annotation></semantics></math>).</p>
</div>
</div>
</div>
<ul>
<li>It is useful to describe a robotâ€™s estimated position in terms of a probability density function over all possible positions of the robot.
<ul>
<li>allows for multiple hypotheses about the robotâ€™s position.</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<center>
<img src="contents/assets/gaussian.png" width="100%">
</center>
</div></div>
</section>
<section>
<section id="dead-reckoning" class="title-slide slide level1 center">
<h1>Dead Reckoning</h1>

</section>
<section id="dead-reckoning-1" class="slide level2 smaller">
<h2>Dead reckoning</h2>
<ul>
<li>An odometer is a sensor that measures distance traveled and sometimes also change in heading direction.
<ul>
<li>For wheeled devices, can be determined by measuring the angular rotation of the wheels.</li>
<li>Direction of travel can be measured using a compass or</li>
<li>Change in heading can be measured using a gyroscope.</li>
</ul></li>
<li>These sensors are imperfect due to systematic errors
<ul>
<li>incorrect wheel radius,</li>
<li>gyroscope bias</li>
</ul></li>
<li>They are also imperfect due to random errors such as slip between wheels and the ground.</li>
<li>Robots w/o wheels, such as aerial and underwater robots, can use visual odometry based on observations of the world moving past the robot.</li>
</ul>
</section>
<section id="modeling-the-vehicle" class="slide level2 smaller">
<h2>Modeling the vehicle</h2>
<ul>
<li>The first step in estimating the robotâ€™s pose is to write a function, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğŸ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{f}(\cdot)</annotation></semantics></math>, that describes how the vehicleâ€™s configuration changes from one time step to the next.</li>
<li>The initial pose is represented in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ğ’</mi><mi>ğ„</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{SE}(2)</annotation></semantics></math> as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¾</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>âˆ¼</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mo>sin</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>x</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>sin</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>cos</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>y</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\xi\langle k \rangle \sim
\begin{pmatrix}
\cos{\theta\langle k \rangle} &amp; -\sin{\theta\langle k \rangle} &amp; x\langle k
\rangle \\ 
\sin{\theta\langle k \rangle} &amp; \cos{\theta\langle k \rangle} &amp; y\langle k
\rangle \\ 
0 &amp; 0 &amp; 1
\end{pmatrix}
</annotation></semantics></math></li>
<li>Move forward in the vehicle <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-direction by <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î´</mi><mi>d</mi></msub><annotation encoding="application/x-tex">\delta_d</annotation></semantics></math> and then rotate by <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î´</mi><mi>Î¸</mi></msub><annotation encoding="application/x-tex">\delta_\theta</annotation></semantics></math> giving the new configuration <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Î¾</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>âˆ¼</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mo>sin</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>x</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>sin</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>cos</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>y</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Î´</mi><mi>d</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mo>sin</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>sin</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>cos</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>âˆ¼</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>x</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>d</mi></msub><mo>cos</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>y</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>d</mi></msub><mo>sin</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\xi\langle k \rangle &amp;\sim
\begin{pmatrix}
\cos{\theta\langle k \rangle} &amp; -\sin{\theta\langle k \rangle} &amp; x\langle k
\rangle \\ 
\sin{\theta\langle k \rangle} &amp; \cos{\theta\langle k \rangle} &amp; y\langle k
\rangle \\ 
0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
1 &amp; 0 &amp; \delta_d \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1
\end{pmatrix}
\begin{pmatrix}
\cos{\delta_\theta} &amp; -\sin{\delta_\theta} &amp; 0 \\
\sin{\delta_\theta} &amp; \cos{\delta_\theta} &amp; 0 \\ 
0 &amp; 0 &amp; 1
\end{pmatrix} \\ 
&amp;\sim
\begin{pmatrix}
\cos{\left(\theta \langle k \rangle + \delta_\theta\right)} &amp;
-\sin{\left(\theta\langle k \rangle + \delta_\theta\right)} &amp; 
x\langle k \rangle + \delta_d \cos{\theta\langle k \rangle} \\
\sin{\left(\theta \langle k \rangle + \delta_\theta\right)} &amp;
\cos{\left(\theta\langle k \rangle + \delta_\theta\right)} &amp; 
y\langle k \rangle + \delta_d \sin{\theta\langle k \rangle} \\
0 &amp; 0 &amp; 1
\end{pmatrix}
\end{aligned}
</annotation></semantics></math></li>
</ul>
</section>
<section id="modeling-the-vehicle-1" class="slide level2 smaller">
<h2>Modeling the vehicle</h2>
<ul>
<li>Letâ€™s represent this succinctly as a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>-vector <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ±</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{x} = (x, y, \theta)</annotation></semantics></math> so that <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ±</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>x</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>d</mi></msub><mo>cos</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>y</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>d</mi></msub><mo>sin</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\bm{x}\langle k+1 \rangle = \begin{pmatrix}
x\langle k \rangle + \delta_d \cos{\theta\langle k \rangle} \\
y\langle k \rangle + \delta_d \sin{\theta\langle k \rangle} \\
\theta\langle k \rangle + \delta_\theta
\end{pmatrix}
</annotation></semantics></math> which gives the new configuration in terms of the previous configuration and the odometry.</li>
<li>Odometry is not perfect and we model the error by imagining a random number generator <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mi>d</mi></msub><mo>,</mo><msub><mi>v</mi><mi>Î¸</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(v_d, v_\theta)</annotation></semantics></math> that corrupts the output of a perfect odometer (<em>sensor noise</em>).</li>
</ul>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Robotâ€™s configuration at the next time step, including odometry error</strong></p>
</div>
<div class="callout-content">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ±</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><mo>=</mo><mi>ğŸ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><mi>Î´</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><mi>ğ¯</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>x</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î´</mi><mi>d</mi></msub><mo>+</mo><msub><mi>v</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>cos</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>y</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î´</mi><mi>d</mi></msub><mo>+</mo><msub><mi>v</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>sin</mo><mrow><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>Î¸</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><msub><mi>Î´</mi><mi>Î¸</mi></msub><mo>+</mo><msub><mi>v</mi><mi>Î¸</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\bm{x}\langle k+1 \rangle = \bm{f}\left( \bm{x}\langle k \rangle, \delta \langle
k \rangle, \bm{v}\langle k \rangle \right) = \begin{pmatrix}
x\langle k \rangle + (\delta_d+v_d) \cos{\theta\langle k \rangle} \\
y\langle k \rangle + (\delta_d+v_d) \sin{\theta\langle k \rangle} \\
\theta\langle k \rangle + \delta_\theta + v_\theta
\end{pmatrix}
</annotation></semantics></math></p>
</div>
</div>
</div>
<ul>
<li>We typically model the odometry noise as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ¯</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mi>d</mi></msub><mo>,</mo><msub><mi>v</mi><mi>Î¸</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup><mo>âˆ¼</mo><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>ğ•</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{v} = \left(v_d,
v_\theta\right)^\top \sim \mathcal{N}(0, \bm{V})</annotation></semantics></math>, a zero-mean multivariate Gaussian, with variance <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ•</mi><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">{</mo><msubsup><mi>Ïƒ</mi><mi>d</mi><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>Ïƒ</mi><mi>Î¸</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{V} = \text{diag}\left\{\sigma_d^2, \sigma_\theta^2
\right\}</annotation></semantics></math>.</li>
</ul>
</section>
<section id="estimating-pose" class="slide level2 smaller">
<h2>Estimating pose</h2>
<center>
<img src="contents/assets/kalman_predict_1d.svg" width="100%">
</center>
</section>
<section id="estimating-pose-1" class="slide level2 smaller">
<h2>Estimating pose</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Shipâ€™s navigator problem</strong></p>
</div>
<div class="callout-content">
<p>How to estimate our new pose given the previous pose and noise odometry?</p>
</div>
</div>
</div>
<ul>
<li>The mathematical tool that we will use is the <em>Kalman filter</em>.
<ul>
<li>provides the optimal estimate of the system state assuming zero-mean Gaussian noise.</li>
</ul></li>
<li>The filter is a recursive algorithm that updates, at each time step, the optimal estimate of the unknown true configuration and the uncertainty associated with that estimate.</li>
<li>The Kalman filter is formulated for linear systems but our model of the vehicleâ€™s motion is nonlinear, so weâ€™ll use the extended Kalman filter (EKF).</li>
<li>For this problem, the state vector is the vehicleâ€™s configuration <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ±</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>v</mi></msub><mo>,</mo><msub><mi>y</mi><mi>v</mi></msub><mo>,</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \bm{x} =
\left(x_v, y_v, \theta_v \right) </annotation></semantics></math> and the prediction equations <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>ğŸ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><mover><mi>ğ®</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>ğ…</mi><mi>x</mi></msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><msubsup><mi>ğ…</mi><mi>x</mi><mi>âŠ¤</mi></msubsup><mo>+</mo><msub><mi>ğ…</mi><mi>v</mi></msub><mover><mi>ğ•</mi><mo accent="true">Ì‚</mo></mover><msubsup><mi>ğ…</mi><mi>v</mi><mi>âŠ¤</mi></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\hat{\bm{x}}^+\langle k+1 \rangle &amp;= \bm{f}\left(\hat{\bm{x}}\langle k \rangle,
\hat{\bm{u}}\langle k \rangle \right) \\
\hat{\bm{P}}^+\langle k+1 \rangle &amp;= \bm{F}_x\hat{\bm{P}}\langle k
\rangle \bm{F}_x^\top + \bm{F}_v \hat{\bm{V}}\bm{F}_v^\top
\end{aligned}
</annotation></semantics></math> describe how the state and covariance evolve with time.</li>
</ul>
</section>
<section id="estimating-pose-2" class="slide level2 smaller">
<h2>Estimating pose</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>ğŸ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><mover><mi>ğ®</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>ğ…</mi><mi>x</mi></msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><msubsup><mi>ğ…</mi><mi>x</mi><mi>âŠ¤</mi></msubsup><mo>+</mo><msub><mi>ğ…</mi><mi>v</mi></msub><mover><mi>ğ•</mi><mo accent="true">Ì‚</mo></mover><msubsup><mi>ğ…</mi><mi>v</mi><mi>âŠ¤</mi></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\hat{\bm{x}}^+\langle k+1 \rangle &amp;= \bm{f}\left(\hat{\bm{x}}\langle k \rangle,
\hat{\bm{u}}\langle k \rangle \right) \\
\hat{\bm{P}}^+\langle k+1 \rangle &amp;= \bm{F}_x\hat{\bm{P}}\langle k
\rangle \bm{F}_x^\top + \bm{F}_v \hat{\bm{V}}\bm{F}_v^\top
\end{aligned}
</annotation></semantics></math></p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ®</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow><annotation encoding="application/x-tex">\hat{\bm{u}}\langle k \rangle</annotation></semantics></math>: input to the process; in this case is the measured odometry, so <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ®</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>=</mo><mi>Î´</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mrow><annotation encoding="application/x-tex">\hat{\bm{u}}\langle k \rangle = \delta \langle k \rangle</annotation></semantics></math>.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>âˆˆ</mo><msup><mi>â„</mi><mrow><mn>3</mn><mo>Ã—</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{\bm{P}} \in \mathbb{R}^{3 \times 3}</annotation></semantics></math> is a covariance matrix representing the uncertainty in the estimated vehicle configuration.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ•</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{V}}</annotation></semantics></math> is our estimate of the covariance of the odometry noise, which in reality, we do not know.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ…</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\bm{F}_x</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ…</mi><mi>v</mi></msub><annotation encoding="application/x-tex">\bm{F}_v</annotation></semantics></math> are Jacobian matrices obtained by differentiating the equations of motion and evaluating the result at <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ¯</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\bm{v} = 0</annotation></semantics></math>, giving <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>ğ…</mi><mi>x</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğŸ</mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ±</mi></mrow></mfrac><msub><mo stretchy="false" form="postfix">|</mo><mrow><mi>ğ¯</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><msub><mi>Î´</mi><mi>d</mi></msub><mo>sin</mo><msub><mi>Î¸</mi><mi>v</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Î´</mi><mi>d</mi></msub><mo>cos</mo><msub><mi>Î¸</mi><mi>v</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>ğ…</mi><mi>v</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğŸ</mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ¯</mi></mrow></mfrac><msub><mo stretchy="false" form="postfix">|</mo><mrow><mi>ğ¯</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><msub><mi>Î¸</mi><mi>v</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>sin</mo><msub><mi>Î¸</mi><mi>v</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\bm{F}_x &amp;= \frac{\partial \bm{f}}{\partial \bm{x}}\vert_{\bm{v}=0} =
\begin{pmatrix}
1 &amp; 0 &amp; -\delta_d \sin{\theta_v} \\ 0 &amp; 1 &amp; \delta_d \cos{\theta_v} \\ 0 &amp; 0 &amp; 1
\end{pmatrix} \\
\bm{F}_v &amp;= \frac{\partial \bm{f}}{\partial \bm{v}}\vert_{\bm{v}=0} = 
\begin{pmatrix}
\cos{\theta_v} &amp; 0 \\ \sin{\theta_v} &amp; 0 \\ 0 &amp; 1
\end{pmatrix}
\end{aligned}
</annotation></semantics></math> which are functions of the current state and odometry.</li>
</ul>
</section>
<section id="estimating-pose-3" class="slide level2 smaller">
<h2>Estimating pose</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>The true (<em>blue</em>) and estimated (<em>red</em>) robot path is shown in the figure to the right.
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math> confidence ellipses are indicated in green.</li>
<li>That is there is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math> chance that the robotâ€™s <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>- and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-coordinate is within <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Â±</mi><mn>2</mn><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">\pm 2\sigma</annotation></semantics></math> bound.</li>
</ul></li>
<li>There are off-diagonal terms in the correlation matrix, which indicate that the uncertainties between the corresponding variables are related.
<ul>
<li>For example, the value <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow><mn>3</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>âˆ’</mi><mn>0.5575</mn></mrow><annotation encoding="application/x-tex">P_{1,3}=P_{3,1} = -0.5575</annotation></semantics></math> indicates the uncertainties in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math> are related.</li>
</ul></li>
<li>The total uncertainty is given by <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mrow><mo>det</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt><annotation encoding="application/x-tex">\sqrt{\det{(\hat{\bm{P}})}}</annotation></semantics></math> and is plotted.
<ul>
<li>It never decreases because RHS of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{P}}</annotation></semantics></math> eqn. is positive definite.</li>
<li>Means that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\bm{P}</annotation></semantics></math>, the position uncertainty can never decrease!</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<center>
<img src="contents/assets/ekf_path.svg" width="80%">
</center>
<center>
<img src="contents/assets/ekf_cov.svg" width="80%">
</center>
</div></div>
</section></section>
<section>
<section id="localizing-with-a-map" class="title-slide slide level1 center">
<h1>Localizing with a Map</h1>

</section>
<section id="localizing-with-a-map-1" class="slide level2 smaller">
<h2>Localizing with a map</h2>
<ul>
<li><p>Recall: uncertainty in position grows without bound using dead-reckoning alone.</p></li>
<li><p>The solution, as the Phoenicians worked out <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">4,000</annotation></semantics></math> years ago, is to bring in additional information from observations of known features in the world.</p>
<ul>
<li>In the examples, we will use a map that contains <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> fixed but randomly located landmarks whose positions are known.</li>
</ul></li>
<li><p>The robot is equipped with a sensor that provides observations of the landmarks w.r.t. the robot, described by <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ³</mi><mo>=</mo><mi>ğ¡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo>,</mo><msub><mi>ğ©</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex"> \bm{z} = \bm{h}(\bm{x}, \bm{p}_i), </annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ©</mi><mi>i</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup></mrow><annotation encoding="application/x-tex">\bm{p}_i = \left(x_i, y_i\right)^\top</annotation></semantics></math> is the <em>known</em> location of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mtext mathvariant="normal">th</mtext></msup><annotation encoding="application/x-tex">i^{\text{th}}</annotation></semantics></math> landmark in the world frame.</p></li>
<li><p>To make this concrete, letâ€™s consider a common type of sensor that measures the range and bearing angle to a landmark in the environment</p>
<ul>
<li>such as a radar or a scanning-laser rangefinder.</li>
</ul></li>
</ul>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Observation of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mtext mathvariant="normal">th</mtext></msup><annotation encoding="application/x-tex">i^{\text{th}}</annotation></semantics></math> landmark</strong></p>
</div>
<div class="callout-content">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ³</mi><mo>=</mo><mi>ğ¡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo>,</mo><msub><mi>ğ©</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msqrt><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>arctan</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mi>Î¸</mi><mi>v</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>Î²</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\bm{z} = \bm{h}(\bm{x}, \bm{p}_i) = 
\begin{pmatrix}
\sqrt{ \left(y_i - y_v \right)^2 + \left(x_i - x_v\right)^2 } \\ 
\arctan{\left(y_i-y_v, x_i-x_v\right)} - \theta_v
\end{pmatrix} + 
\begin{pmatrix} w_r \\ w_\beta \end{pmatrix}
</annotation></semantics></math></p>
</div>
</div>
</div>
</section>
<section id="localizing-with-a-map-2" class="slide level2 smaller">
<h2>Localizing with a map</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Observation of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mtext mathvariant="normal">th</mtext></msup><annotation encoding="application/x-tex">i^{\text{th}}</annotation></semantics></math> landmark</strong></p>
</div>
<div class="callout-content">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ³</mi><mo>=</mo><mi>ğ¡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo>,</mo><msub><mi>ğ©</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msqrt><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>arctan</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mi>Î¸</mi><mi>v</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>r</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mi>Î²</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\bm{z} = \bm{h}(\bm{x}, \bm{p}_i) = 
\begin{pmatrix}
\sqrt{ \left(y_i - y_v \right)^2 + \left(x_i - x_v\right)^2 } \\ 
\arctan{\left(y_i-y_v, x_i-x_v\right)} - \theta_v
\end{pmatrix} + 
\begin{pmatrix} w_r \\ w_\beta \end{pmatrix}
</annotation></semantics></math></p>
</div>
</div>
</div>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ³</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup></mrow><annotation encoding="application/x-tex">\bm{z} = (r, \beta)^\top</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math> is the range, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î²</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math> is the bearing angle.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ°</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>r</mi></msub><mo>,</mo><msub><mi>w</mi><mi>Î²</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup><mo>âˆ¼</mo><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>ğ–</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><mi>ğ–</mi><mo>=</mo><mtext mathvariant="normal">diag</mtext><mo stretchy="false" form="prefix">{</mo><msubsup><mi>Ïƒ</mi><mi>r</mi><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>Ïƒ</mi><mi>Î²</mi><mn>2</mn></msubsup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\bm{w} = \left(w_r, w_\beta\right)^\top \sim \mathcal{N}(0, \bm{W}), \;\;
\bm{W} = \text{diag}\{ \sigma_r^2, \sigma_\beta^2 \}</annotation></semantics></math>: constant covariance matrix.</li>
<li>In implementation, this sensor return the range and bearing to some landmark along with its identity (to avoid data association problem).
<ul>
<li>Recall: the location <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_i, y_i)</annotation></semantics></math> of the measured landmark is known in the world frame.</li>
</ul></li>
<li>Using the equation above, the robot can estimate the range and bearing angle to the landmark based on its own estimated position and the known position of the landmark from the map.</li>
<li>Any difference between the observation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ğ³</mi><mi>â™¯</mi></msup><annotation encoding="application/x-tex">\bm{z}^\sharp</annotation></semantics></math> and the estimated observation indicates an error in the robotâ€™s pose estimate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{x}}</annotation></semantics></math> â€“ it isnâ€™t where it <em>thought</em> it was!</li>
</ul>
</section>
<section id="localizing-with-a-map-3" class="slide level2 smaller">
<h2>Localizing with a map</h2>
<ul>
<li>This difference</li>
</ul>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Observation error</strong></p>
</div>
<div class="callout-content">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>=</mo><msup><mi>ğ³</mi><mi>â™¯</mi></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>âˆ’</mo><mi>ğ¡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><msub><mi>ğ©</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\bm{\nu}\langle k \rangle = \bm{z}^\sharp \langle k \rangle - \bm{h}\left(\hat{{\bm{x}}} 
\langle k \rangle, \bm{p}_i \right)
</annotation></semantics></math></p>
</div>
</div>
</div>
<p>is key to the operation of the Kalman filter.</p>
<ul>
<li>It is called the <em>innovation</em> since it represents <em>new</em> information.</li>
<li>Kalman filter uses the innovation to correct the state estimate and update the uncertainty estimate in an optimal way.</li>
<li>The predicted state, computed earlier, is updated by</li>
</ul>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Kalman filter update equations</strong></p>
</div>
<div class="callout-content">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><mi>ğŠ</mi><mi>ğ›</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><mo>âˆ’</mo><mi>ğŠ</mi><msub><mi>ğ‡</mi><mi>x</mi></msub><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\hat{\bm{x}} \langle k+1 \rangle &amp;= \hat{\bm{x}}^+ \langle k+1 \rangle +
\bm{K}\bm{\nu}\langle k + 1 \rangle \\
\hat{\bm{P}} \langle k+1 \rangle &amp;= \hat{\bm{P}}^+ \langle k+1 \rangle -
\bm{K}\bm{H}_x\hat{\bm{P}}^+ \langle k+1 \rangle
\end{aligned}
</annotation></semantics></math></p>
</div>
</div>
</div>
</section>
<section id="localizing-with-a-map-4" class="slide level2 smaller">
<h2>Localizing with a map</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Kalman filter update equations</strong></p>
</div>
<div class="callout-content">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><mo>+</mo><mi>ğŠ</mi><mi>ğ›</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><mo>âˆ’</mo><mi>ğŠ</mi><msub><mi>ğ‡</mi><mi>x</mi></msub><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\hat{\bm{x}} \langle k+1 \rangle &amp;= \hat{\bm{x}}^+ \langle k+1 \rangle +
\bm{K}\bm{\nu} \\
\hat{\bm{P}} \langle k+1 \rangle &amp;= \hat{\bm{P}}^+ \langle k+1 \rangle -
\bm{K}\bm{H}_x\hat{\bm{P}}^+ \langle k+1 \rangle
\end{aligned}
</annotation></semantics></math></p>
</div>
</div>
</div>
<ul>
<li>These take the <em>predicted</em> values for the next time step, denoted with the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mspace width="0.222em"></mspace><mo>+</mo></msup><annotation encoding="application/x-tex">{~}^+</annotation></semantics></math> and compute the optimal estimate by applying landmark measurement from step <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math>.</li>
</ul>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Kalman gain</strong></p>
</div>
<div class="callout-content">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>ğŠ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mi>ğ</mi><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><msubsup><mi>ğ‡</mi><mi>x</mi><mi>âŠ¤</mi></msubsup><msup><mi>ğ’</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>ğ’</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>ğ‡</mi><mi>x</mi></msub><msup><mi>ğ</mi><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo><msubsup><mi>ğ‡</mi><mi>x</mi><mi>âŠ¤</mi></msubsup><mo>+</mo><msub><mi>ğ‡</mi><mi>w</mi></msub><mover><mi>ğ–</mi><mo accent="true">Ì‚</mo></mover><msubsup><mi>ğ‡</mi><mi>w</mi><mi>âŠ¤</mi></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\bm{K} &amp;= \bm{P}^+ \langle k+1 \rangle \bm{H}_x^\top \bm{S}^{-1} \\
\bm{S} &amp;= \bm{H}_x \bm{P}^+ \langle k+1 \rangle \bm{H}_x^\top + \bm{H}_w
\hat{\bm{W}} \bm{H}_w^\top
\end{aligned}
</annotation></semantics></math></p>
</div>
</div>
</div>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ–</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{W}}</annotation></semantics></math> is the estimated covariance of the sensor noise and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ‡</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\bm{H}_x</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ‡</mi><mi>w</mi></msub><annotation encoding="application/x-tex">\bm{H}_w</annotation></semantics></math> are Jacobians</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‡</mi><mi>x</mi></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ¡</mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ±</mi></mrow></mfrac><msub><mo stretchy="false" form="postfix">|</mo><mrow><mi>ğ°</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mfrac><mn>1</mn><mi>r</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mfrac><mn>1</mn><mi>r</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mi>r</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mfrac><mn>1</mn><mi>r</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mspace width="1.0em"></mspace><msub><mi>ğ‡</mi><mi>w</mi></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ¡</mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ°</mi></mrow></mfrac><msub><mo stretchy="false" form="postfix">|</mo><mrow><mi>ğ°</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\bm{H}_x = \frac{\partial \bm{h}}{\partial \bm{x}}\vert_{\bm{w}=0} = 
\begin{pmatrix}
-\frac{1}{r}\left(x_i - x_v\right) &amp; -\frac{1}{r}\left(y_i - y_v\right) &amp; 0 \\
\frac{1}{r}\left(y_i - y_v\right) &amp; -\frac{1}{r}\left(x_i - x_v\right) &amp; -1
\end{pmatrix}, \quad\quad
\bm{H}_w = \frac{\partial \bm{h}}{\partial \bm{w}}\vert_{\bm{w}=0} = 
\begin{pmatrix}
1 &amp; 0 \\ 0 &amp; 1
\end{pmatrix}.
</annotation></semantics></math></p>
</section>
<section id="localizing-with-a-map-5" class="slide level2 smaller">
<h2>Localizing with a map</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>&nbsp;</p>
<ul>
<li><p>The Kalman gain matrix <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğŠ</mi><annotation encoding="application/x-tex">\bm{K}</annotation></semantics></math> <em>distributes</em> the innovation from the landmark observation, a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>-vector, to update every element of the state vector.</p></li>
<li><p>Note that the second term in the covariance update equation is <em>subtracted</em> from the estimated covariance.</p>
<ul>
<li>This provides a means for estimated covariance to decrease, which was not possible for the dead-reckoning case.</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<p>&nbsp;</p>
<p>&nbsp;</p>
<center>
<img src="contents/assets/kalman_summary.png" width="100%">
</center>
</div></div>
</section>
<section id="localizing-with-a-map-6" class="slide level2 smaller">
<h2>Localizing with a map</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>EKF localization
<ul>
<li>Blue: true path of the robot,</li>
<li>Red: estimated path from odometry and landmarks,</li>
<li>Stars: landmarks.</li>
</ul></li>
<li>The error ellipses are now much smaller â€“ many can hardly be seen.</li>
<li>The bottom figure shows a zoomed view of the robotâ€™s actual and estimated path (moving from top to bottom).
<ul>
<li>The error ellipses grow as the robot moves and then shrinks just after a jag in the estimated path.</li>
<li>This corresponds to the observation of a landmark.</li>
<li>New information, beyond odometry, has been used to correct the state in the Kalman filter update phase.</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<center>
<img src="contents/assets/ekfpath_wmap.svg" width="75%">
</center>
<center>
<img src="contents/assets/ekfpath_wmap_closeup.svg" width="75%">
</center>
</div></div>
</section>
<section id="localizing-with-a-map-7" class="slide level2 smaller">
<h2>Localizing with a map</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>Overall uncertainty is no longer growing monotonically
<ul>
<li>When the robot sees a landmark, it is able to dramatically reduce its estimated covariance.</li>
</ul></li>
<li>The bottom figure shows the error associated with each component of pose
<ul>
<li>The pink background is estimated <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math> confidence bound (derived from the covariance matrix).</li>
<li>Notice the error is mostly within this envelope.</li>
</ul></li>
<li>Below this is plotted the landmark observations
<ul>
<li>Notice that the confidence bounds are tight (indicating low uncertainty) while landmarks are being observed.</li>
<li>They start to grow once observations stop.</li>
<li>As soon as an observation is made the uncertainty rapidly decreases.</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<center>
<img src="contents/assets/ekf_cov_wmap.svg" width="500" height="300">
</center>
<center>
<img src="contents/assets/confbounds.svg" width="500" height="300">
</center>
</div></div>
</section></section>
<section>
<section id="creating-a-map" class="title-slide slide level1 center">
<h1>Creating a Map</h1>

</section>
<section id="creating-a-map-1" class="slide level2 smaller">
<h2>Creating a map</h2>
<ul>
<li>Somebody or something has to create the maps we will use.</li>
</ul>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Assumptions:</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Sensor can determine the identity of each observed landmark.</li>
<li>The robot knows its own position perfectly (ideal localization).</li>
</ul>
</div>
</div>
</div>
<ul>
<li><p>We need to estimate the coordinates of the landmarks. Hence for this problem, the state vector comprises the estimated coordinates of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math> landmarks we have observed so far: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>x</mi><mi>M</mi></msub><mo>,</mo><msub><mi>y</mi><mi>M</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆˆ</mo><msup><mi>â„</mi><mrow><mn>2</mn><mi>M</mi><mo>Ã—</mo><mn>1</mn></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> \hat{\bm{x}} = \left(x_1, y_1, x_2, y_2, \ldots, x_M, y_M \right)
\in \mathbb{R}^{2M \times 1}. </annotation></semantics></math></p></li>
<li><p>The corresponding estimated covariance <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{P}}</annotation></semantics></math> will be a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>M</mi><mo>Ã—</mo><mn>2</mn><mi>M</mi></mrow><annotation encoding="application/x-tex">2M \times 2M</annotation></semantics></math> matrix.</p></li>
<li><p>The state vector has variable length since we do not know in advance how many landmarks exist.</p>
<ul>
<li>Initially <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">M = 0</annotation></semantics></math> and is incremented every time a previously unseen landmark is observed.</li>
</ul></li>
</ul>
</section>
<section id="creating-a-map-2" class="slide level2 smaller">
<h2>Creating a map</h2>
<ul>
<li><p>The prediction equation is straightforward since the landmarks are stationary. <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo></msup><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\hat{\bm{x}} \langle k+1 \rangle &amp;= \hat{\bm{x}} \langle k \rangle \\
\hat{\bm{P}}^+ \langle k+1 \rangle &amp;= \hat{\bm{P}} \langle k \rangle
\end{aligned}
</annotation></semantics></math></p></li>
<li><p>We introduce the function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ </mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{g}(\cdot)</annotation></semantics></math>, the inverse of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ¡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{h}(\cdot)</annotation></semantics></math>, which gives the coordinates of the observed landmark based on the known vehicle pose and the sensor observation <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ </mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo>,</mo><mi>ğ³</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mi>v</mi></msub><mo>+</mo><mi>r</mi><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mi>v</mi></msub><mo>+</mo><mi>r</mi><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \bm{g}(\bm{x}, \bm{z}) = \begin{pmatrix}
x_v + r \cos{\left(\theta_v + \beta\right)} \\
y_v + r \sin{\left(\theta_v + \beta\right)}
\end{pmatrix} </annotation></semantics></math></p></li>
<li><p>Since <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{x}}</annotation></semantics></math> has a variable length, we need to extend the state vector and the covariance matrix whenever we encounter a previously unseen landmark. <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ±</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><msup><mo stretchy="false" form="postfix">âŸ©</mo><mi>â€²</mi></msup><mo>=</mo><mi>ğ²</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><mi>ğ³</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><msub><mi>ğ±</mi><mi>v</mi></msub><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>ğ±</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>ğ </mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>v</mi></msub><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo>,</mo><mi>ğ³</mi><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> 
\bm{x} \langle k \rangle^\prime = \bm{y}\left(\bm{x} \langle k \rangle,
\bm{z}\langle k \rangle, \bm{x}_v \langle k \rangle \right) 
= \begin{pmatrix}
\bm{x} \langle k \rangle \\
\bm{g} \left(\bm{x}_v \langle k \rangle, \bm{z} \langle k \rangle \right)
\end{pmatrix}.
</annotation></semantics></math></p>
<ul>
<li>This appends the sensor-based estimate of the new landmarkâ€™s coordinates to those already in the map.</li>
<li>The order of feature coordinates within <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\bm{x}}</annotation></semantics></math> therefore depends on the order in which they are observed.</li>
</ul></li>
</ul>
</section>
<section id="creating-a-map-3" class="slide level2 smaller">
<h2>Creating a map</h2>
<ul>
<li>The covariance matrix also needs to be extended when a new landmark is observed and this is achieved by <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><msup><mo stretchy="false" form="postfix">âŸ©</mo><mi>â€²</mi></msup><mo>=</mo><msub><mi>ğ˜</mi><mi>z</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="false" form="prefix">âŸ¨</mo><mi>k</mi><mo stretchy="false" form="postfix">âŸ©</mo></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mn>2</mn><mo>Ã—</mo><mi>M</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mn>2</mn><mo>Ã—</mo><mi>M</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mover><mi>ğ–</mi><mo accent="true">Ì‚</mo></mover></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>ğ˜</mi><mi>z</mi><mi>âŠ¤</mi></msubsup></mrow><annotation encoding="application/x-tex"> \hat{\bm{P}} \langle k \rangle^\prime = \bm{Y}_z \begin{pmatrix}
\hat{\bm{P}}\langle k \rangle &amp; \bm{0}_{2\times M} \\ \bm{0}_{2\times M} &amp; 
\hat{\bm{W}} \end{pmatrix} \bm{Y}_z^\top </annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ˜</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\bm{Y}_z</annotation></semantics></math> is the insertion Jacobian <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ˜</mi><mi>z</mi></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ²</mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ³</mi></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ğˆ</mi><mrow><mi>M</mi><mo>Ã—</mo><mi>M</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mi>M</mi><mo>Ã—</mo><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ğ†</mi><mi>x</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mn>2</mn><mo>Ã—</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>âˆ’</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ğ†</mi><mi>z</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \bm{Y}_z =
\frac{\partial \bm{y}}{\partial \bm{z}} = \begin{pmatrix} \bm{I}_{M \times M} &amp;
&amp; \bm{0}_{M \times 2} \\ \bm{G}_x &amp; \bm{0}_{2 \times (M-3)} &amp; \bm{G}_z
\end{pmatrix} </annotation></semantics></math> that relates the rate of change of the extended state vector to the new observation, and</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ†</mi><mi>x</mi></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ </mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ±</mi></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mspace width="1.0em"></mspace><msub><mi>ğ†</mi><mi>z</mi></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ </mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ³</mi></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mi>r</mi><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>r</mi><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\bm{G}_x = \frac{\partial \bm{g}}{\partial \bm{x}} = \begin{pmatrix} 0 &amp; 0 &amp; 0
\\ 0 &amp; 0 &amp; 0 \end{pmatrix}, \quad\quad
\bm{G}_z = \frac{\partial \bm{g}}{\partial \bm{z}} = \begin{pmatrix} 
\cos{\left(\theta_v + \beta\right)} &amp; -r\sin{\left(\theta_v + \beta\right)} \\
\sin{\left(\theta_v + \beta\right)} &amp; r\cos{\left(\theta_v + \beta\right)}
\end{pmatrix}
</annotation></semantics></math></p>
<ul>
<li><p>An additional Jacobian for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ¡</mi><mrow><mo stretchy="true" form="prefix" mathvariant="bold">(</mo><mi mathvariant="bold">â‹…</mi><mo stretchy="true" form="postfix" mathvariant="bold">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{h(\cdot)}</annotation></semantics></math> is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ‡</mi><msub><mi>p</mi><mi>i</mi></msub></msub><annotation encoding="application/x-tex">\bm{H}_{p_i}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ‡</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\bm{H}_x</annotation></semantics></math> looks like <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ¡</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{h}(\cdot)</annotation></semantics></math> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‡</mi><msub><mi>p</mi><mi>i</mi></msub></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ¡</mi></mrow><mrow><mi>âˆ‚</mi><msub><mi>ğ©</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mi>r</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mi>r</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mfrac><mn>1</mn><msup><mi>r</mi><mn>2</mn></msup></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><msup><mi>r</mi><mn>2</mn></msup></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>;</mo><mspace width="1.0em"></mspace><msub><mi>ğ‡</mi><mi>x</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mn>2</mn><mo>Ã—</mo><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ğ‡</mi><msub><mi>p</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mn>2</mn><mo>Ã—</mo><mn>2</mn></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex"> \bm{H}_{p_i} = \frac{\partial \bm{h}}{\partial \bm{p}_i} = \begin{pmatrix} 
\frac{1}{r}\left(x_i - x_v\right) &amp; \frac{1}{r}\left(y_i - y_v\right) \\
-\frac{1}{r^2}\left(y_i - y_v\right) &amp; \frac{1}{r^2}\left(x_i - x_v\right)
\end{pmatrix}; \quad \bm{H}_x = \begin{bmatrix}\bm{0}_{2\times 2} &amp; \cdots &amp; 
\bm{H}_{p_i} &amp; \cdots &amp; \bm{0}_{2 \times 2}\end{bmatrix} </annotation></semantics></math></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ‡</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\bm{H}_x</annotation></semantics></math> describes how the landmark observation changes w.r.t. the full state vector.</p></li>
</ul>
</section>
<section id="creating-a-map-4" class="slide level2 smaller">
<h2>Creating a map</h2>
<center>
<img src="contents/assets/mapcreation.svg" width="100%">
</center>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>EKF mapping results</strong></p>
</div>
<div class="callout-content">
<p>The estimated landmarks are indicated by <em>black dots</em> with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math> confidence ellipses (<em>green</em>, hard to see w/o zooming), the true location (<em>black star marker</em>) and the robotâ€™s path (<em>blue</em>). The landmark estimates have not fully converged to their true values.</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="localization-and-mapping" class="title-slide slide level1 center">
<h1>Localization and Mapping</h1>

</section>
<section id="simultaneous-localization-and-mapping" class="slide level2 smaller">
<h2>Simultaneous localization and mapping</h2>
<ul>
<li><p>Feels like a â€˜â€™chicken and eggâ€™â€™ problem</p>
<ul>
<li>we need a map to localize and</li>
<li>we need to localize to make a map.</li>
</ul></li>
<li><p>However, based on what we have learned so far this problem is now quite straightforward to solve.</p></li>
<li><p>The state vector comprises the vehicle configuration <em>and</em> the coordinates of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math> landmarks that have been observed so far <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ±</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>v</mi></msub><mo>,</mo><msub><mi>y</mi><mi>v</mi></msub><mo>,</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>x</mi><mi>M</mi></msub><mo>,</mo><msub><mi>y</mi><mi>M</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup><mo>âˆˆ</mo><msup><mi>â„</mi><mrow><mn>2</mn><mi>M</mi><mo>+</mo><mn>3</mn><mo>Ã—</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex"> \hat{\bm{x}} =
\left(x_v, y_v, \theta_v, x_1, y_1, x_2, y_2, \ldots, x_M, y_M \right)^\top \in
\mathbb{R}^{2M+3 \times 1} </annotation></semantics></math></p></li>
<li><p>The estimated covariance is a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>M</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>Ã—</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>M</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(2M+3) \times (2M+3)</annotation></semantics></math> matrix and has the structure <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>v</mi><mi>v</mi></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>v</mi><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>v</mi><mi>m</mi></mrow><mi>âŠ¤</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mi>m</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \hat{\bm{P}} = \begin{pmatrix} \hat{\bm{P}}_{vv} &amp;
\hat{\bm{P}}_{vm} \\ \hat{\bm{P}}_{vm}^\top &amp; \hat{\bm{P}}_{mm} \end{pmatrix} </annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>v</mi><mi>v</mi></mrow></msub><annotation encoding="application/x-tex">\hat{\bm{P}}_{vv}</annotation></semantics></math> is the covariance of the vehicle pose, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">\hat{\bm{P}}_{mm}</annotation></semantics></math> the covariance of the map landmark positions, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>v</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">\hat{\bm{P}}_{vm}</annotation></semantics></math> is the correlation between vehicle landmark states.</p></li>
</ul>
</section>
<section id="slam" class="slide level2 smaller">
<h2>SLAM</h2>
<ul>
<li><p>The predicted vehicle state and covariances are as they were given in localization section with perfect map knowledge.</p></li>
<li><p>When a new feature is observed the state vector is updated using the insertion Jacobian <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ˜</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\bm{Y}_z</annotation></semantics></math> but in this case <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ†</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\bm{G}_x</annotation></semantics></math> is nonzero <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ†</mi><mi>x</mi></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ </mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ±</mi></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>âˆ’</mi><mi>r</mi><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>r</mi><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>v</mi></msub><mo>+</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \bm{G}_x = \frac{\partial \bm{g}}{\partial \bm{x}} = \begin{pmatrix} 
1 &amp; 0 &amp; -r \sin{\left(\theta_v + \beta\right)} \\
0 &amp; 1 &amp; r \cos{\left(\theta_v + \beta\right)} \end{pmatrix} </annotation></semantics></math> since the estimate of the new landmark depends on the state vector which now contains the vehicleâ€™s pose.</p></li>
<li><p>For SLAM, the Jacobian <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ‡</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\bm{H}_x</annotation></semantics></math> describes how the landmark observation changes w.r.t. the state vector. The observation will depend on the position of the vehicle and on the position of the observed landmark <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‡</mi><mi>x</mi></msub><mo>=</mo><mfrac><mrow><mi>âˆ‚</mi><mi>ğ¡</mi></mrow><mrow><mi>âˆ‚</mi><mi>ğ±</mi></mrow></mfrac><msub><mo stretchy="false" form="postfix">|</mo><mrow><mi>w</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ğ‡</mi><msub><mi>x</mi><mi>v</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mn>2</mn><mo>Ã—</mo><mn>2</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ğ‡</mi><msub><mi>p</mi><mi>i</mi></msub></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>ğŸ</mn><mrow><mn>2</mn><mo>Ã—</mo><mn>2</mn></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆˆ</mo><msup><mi>â„</mi><mrow><mn>2</mn><mo>Ã—</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>M</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> \bm{H}_x =
\frac{\partial \bm{h}}{\partial \bm{x}}\vert_{w=0} = \begin{pmatrix}
\bm{H}_{x_v} &amp; \cdots &amp; \bm{0}_{2 \times 2} &amp; \cdots &amp; \bm{H}_{p_i} &amp; \cdots &amp; 
\bm{0}_{2 \times 2} \end{pmatrix} âˆˆ \mathbb{R}^{2 \times \left(2M+3\right)}. </annotation></semantics></math></p></li>
<li><p>Now, the Kalman gain matrix <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğŠ</mi><annotation encoding="application/x-tex">\bm{K}</annotation></semantics></math> <em>distributes</em> innovation from the landmark observation, a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>-vector, to update <em>every</em> element of the state vector â€“ the pose of the vehicle <em>and</em> the position of <em>every</em> landmark in the map.</p></li>
</ul>
</section>
<section id="slam-results" class="slide level2 smaller">
<h2>SLAM â€“ results</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>SLAM â€“ path</strong></p>
</div>
<div class="callout-content">
<p>Simultaneous localization and mapping showing the true (<em>blue</em>) and estimated (<em>red</em>) robot path superimposed on the true map (<em>black star marker</em>). The estimated map features are indicated by <em>black dots</em> with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math> confidence ellipses (<em>green</em>).</p>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<center>
<img src="contents/assets/slam-path.png" width="60%">
</center>
</div></div>
<div class="columns">
<div class="column" style="width:60%;">
<p><img src="contents/assets/slam-covariance.png" width="90%"></p>
</div><div class="column" style="width:40%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>SLAM â€“ covariance</strong></p>
</div>
<div class="callout-content">
<p>The final covariance matrix is shown graphically on the right. The landmark uncertainties never increase.</p>
<p>The position prediction model is that they do not move, but they also never drop below the initial uncertainty of the vehicle.</p>
</div>
</div>
</div>
</div></div>
<ul>
<li>The correlations are used by the Kalman filter to connect the observation of any landmark to an improvement in the estimate of every other landmark in the map as well as the vehicle pose. It is as if all the states were connected by springs.</li>
</ul>
</section></section>
<section>
<section id="pose-graph-slam" class="title-slide slide level1 center">
<h1>Pose Graph SLAM</h1>

</section>
<section id="pose-graph-slam-1" class="slide level2 smaller">
<h2>Pose Graph SLAM</h2>
<p>&nbsp;</p>
<ul>
<li>An alternative approach to the SLAM problem is to separate it into two components:
<ul>
<li>a front-end and a back-end</li>
</ul></li>
<li>The robotâ€™s path is considered to be a sequence of distinct poses.</li>
<li>The task is to estimate those poses.</li>
<li>Constraints between the unknown poses are based on measurements from a variety of sensors including odometry, laser scanners and cameras.</li>
</ul>
<center>
<img data-src="contents/assets/fig6_13.svg">
</center>
</section>
<section id="pose-graph-slam-2" class="slide level2 smaller">
<h2>Pose Graph SLAM</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>The problem is formulated as a directed graph.</li>
<li>A node corresponds to a robot pose or a landmark position.</li>
<li>An edge between two nodes represents a spatial constraint between the nodes derived from some sensor data.</li>
</ul>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Dead-reckoning example</strong></p>
</div>
<div class="callout-content">
<p>The robot travels around a square. By the time the robot reaches node <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn><annotation encoding="application/x-tex">4</annotation></semantics></math>, the error is significant.</p>
<p>However, when it makes a measurement of node <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>, a consraint is added â€“ the dashed edge â€“ indicating that the nodes are closer than the estimated relative pose based on the chain of relative poses from odometry: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>1</mn></msup><msubsup><mi>Î¾</mi><mn>2</mn><mi>â™¯</mi></msubsup><mo>âŠ•</mo><msup><mi></mi><mn>2</mn></msup><msubsup><mi>Î¾</mi><mn>3</mn><mi>â™¯</mi></msubsup><mo>âŠ•</mo><msup><mi></mi><mn>3</mn></msup><msubsup><mi>Î¾</mi><mn>4</mn><mi>â™¯</mi></msubsup></mrow><annotation encoding="application/x-tex">{^1}\xi_2^\sharp
\oplus {^2}\xi_3^\sharp \oplus {^3}\xi_4^\sharp</annotation></semantics></math>.</p>
<p>The back-end algorithm will then <em>pull</em> all the nodes closer to their correct pose.</p>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<center>
<img data-src="contents/assets/fig6_14.svg" width="100%">
</center>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Pose-graph SLAM example</strong></p>
</div>
<div class="callout-content">
<p>Places are shown as <em>circular nodes</em> and have an associated pose.</p>
<p>Landmarks are shown as <em>star-shaped nodes</em> and have an associated pose.</p>
<p>Edges represent a measurement of a relative pose or position w.r.t. the node at the tail of the arrow.</p>
</div>
</div>
</div>
</div></div>
</section>
<section id="pose-graph-slam-3" class="slide level2 smaller">
<h2>Pose Graph SLAM</h2>
<div class="columns">
<ul>
<li>The front-end adds new nodes as the robot travels as well as edges that define constraints between poses. E.g.:
<ul>
<li>When moving from one place to another wheel odometry gives an estimate of distance and change in orientation, which is a constraint.</li>
<li>The robotâ€™s exteroceptive sensors may observe the relative position of a landmark and this also adds a constraint.</li>
</ul></li>
<li>Every measurement adds a constraint â€“ an edge in the graph.
<ul>
<li>There is no limit to the number of edges entering or leaving a node.</li>
</ul></li>
</ul><div class="column" style="width:50%;">
<ul>
<li>The back-end adjusts the poses of the nodes so that the constraints are satisfied as well as possible
<ul>
<li>The sensor observations are explained optimally.</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<center>
<img data-src="contents/assets/fig6_13.svg">
</center>
</div></div>
</section>
<section id="pose-graph-slam-4" class="slide level2 smaller">
<h2>Pose Graph SLAM</h2>
<div class="columns">
<ul>
<li><p>Coordinate frames <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{i\}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>j</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{j\}</annotation></semantics></math> are associated with robot poses <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.</p></li>
<li><p>We seek to estimate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_i</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_j</annotation></semantics></math> in the world coordinate frame.</p></li>
</ul><div class="column" style="width:70%;">
<ul>
<li><p>The robot makes a measurement of the relative pose <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>i</mi></msup><msubsup><mi>Î¾</mi><mi>j</mi><mi>â™¯</mi></msubsup></mrow><annotation encoding="application/x-tex">{^i}\xi_j^\sharp</annotation></semantics></math> which will, in general, be different than the relative pose <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>i</mi></msup><msub><mi>Î¾</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{^i}\xi_j</annotation></semantics></math> inferred from poses <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_i</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_j</annotation></semantics></math>.</p></li>
<li><p>The difference, or <em>innovation</em>, is caused by the error in the sensor measurement <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>i</mi></msup><msubsup><mi>Î¾</mi><mi>j</mi><mi>â™¯</mi></msubsup></mrow><annotation encoding="application/x-tex">{^i}\xi_j^\sharp</annotation></semantics></math> and/or the node poses <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_i</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_j</annotation></semantics></math>.</p>
<ul>
<li>We use it to adjust the poses of the nodes.</li>
</ul></li>
<li><p>There is insufficient information to determine where the error lies</p>
<ul>
<li>Naively adjusting <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_i</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{^0}\xi_j</annotation></semantics></math> to better explain the measurement might increase the error in another part of the graph.</li>
<li>We need to minimize the error consistently over the whole graph.</li>
</ul></li>
</ul>
</div><div class="column" style="width:30%;">
<center>
<img data-src="contents/assets/fig6_15.svg">
</center>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Pose graph notation</strong></p>
</div>
<div class="callout-content">
<p>The <em>light gray robot</em> is the estimated pose of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>j</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{j\}</annotation></semantics></math> based on the sensor measurement <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>i</mi></msup><msubsup><mi>Î¾</mi><mi>j</mi><mi>â™¯</mi></msubsup></mrow><annotation encoding="application/x-tex">{^i}\xi_j^\sharp</annotation></semantics></math>.</p>
<p>The <em>yellow ellipse</em> indicates the uncertainty associated with that measurement.</p>
</div>
</div>
</div>
</div></div>
</section>
<section id="pose-graph-slam-5" class="slide level2 smaller">
<h2>Pose Graph SLAM</h2>
<ul>
<li>The first step is to express the error associated with the graph edge in terms of the sensor measurement and our best estimates of the node poses w.r.t. the world frame <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¾</mi><mi>Îµ</mi></msub><mo>=</mo><mi>âŠ–</mi><msup><mi></mi><mi>i</mi></msup><msubsup><mi>Î¾</mi><mi>j</mi><mi>â™¯</mi></msubsup><mo>âŠ–</mo><msup><mi></mi><mn>0</mn></msup><msub><mover><mi>Î¾</mi><mo accent="true">Ì‚</mo></mover><mi>i</mi></msub><mo>âŠ•</mo><msup><mi></mi><mn>0</mn></msup><msub><mover><mi>Î¾</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub><mo>âˆˆ</mo><mrow><mi>ğ’</mi><mi>ğ„</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \xi_\varepsilon = \ominus {^i}\xi_j^\sharp \ominus
{^0}\hat{\xi}_i \oplus {^0}\hat{\xi}_j \in \bm{SE}(2) </annotation></semantics></math> which is ideally zero.</li>
</ul>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>We can formulate this as a minimization problem and attempt to find the poses of all the nodes <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ±</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>Î¾</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Î¾</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î¾</mi><mi>N</mi></msub><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{x} = \left\{ \xi_1, \xi_2, \ldots, \xi_N \right\}</annotation></semantics></math> that minimizes the error across all the edges <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ±</mi><mo>*</mo></msup><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mi>ğ±</mi></munder><munder><mo>âˆ‘</mo><mi>k</mi></munder><msub><mi>F</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \bm{x}^* = \arg \min_\bm{x} \sum_k
F_k(\bm{x}) </annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math> is the state of the pose graph and contains the pose of every node.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_k(\bm{x})</annotation></semantics></math> is a nonnegative scalar cost associated with the edge <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> connecting node <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> to node <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.</li>
</ul></li>
</ul>
</div><div class="column" style="width:30%;">
<center>
<img data-src="contents/assets/fig6_15.svg">
</center>
</div><ul>
<li>If we convert edge pose error to a vector representation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¾</mi><mi>Îµ</mi></msub><mo>âˆ¼</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ğŸ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi_\varepsilon \sim
(x, y, \theta) = \bm{f}_k(\bm{x})</annotation></semantics></math> then the scalar cost can be obtained as a quadratic expression <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ…</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>ğŸ</mi><mi>k</mi><mi>âŠ¤</mi></msubsup><msub><mi>ğ›€</mi><mi>k</mi></msub><msub><mi>ğŸ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \bm{F}_k(\bm{x}) = \bm{f}_k^\top \bm{\Omega}_k
\bm{f}_k(\bm{x}). </annotation></semantics></math></li>
</ul>
</div>
</section>
<section id="pose-graph-slam-6" class="slide level2 smaller">
<h2>Pose Graph SLAM</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>The pose graph can also include landmarks as shown in the figure.</li>
<li>Landmarks have a position <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ</mi><mi>j</mi></msub><mo>âˆˆ</mo><msup><mi>â„</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\bm{P}_j \in \mathbb{R}^2</annotation></semantics></math>, not a pose, and therefore differ from the nodes discussed so far.</li>
<li>To accommodate this, we redefine the state vector <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ±</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>Î¾</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Î¾</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î¾</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">|</mo><msub><mi>ğ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>ğ</mi><mi>M</mi></msub><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{x} = \left\{ \xi_1,
\xi_2, \ldots, \xi_n \vert \bm{P}_1, \bm{P}_2, \ldots, \bm{P}_M \right\}</annotation></semantics></math>.</li>
</ul>
</div><div class="column" style="width:30%;">
<center>
<img data-src="contents/assets/fig6_18.svg">
</center>
</div><ul>
<li><p>The robot at pose <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> observes landmark <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> at range and bearing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ³</mi><mi>â™¯</mi></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>r</mi><mi>â™¯</mi></msup><mo>,</mo><msup><mi>Î²</mi><mi>â™¯</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{z}^\sharp = \left( r^\sharp, \beta^\sharp \right)</annotation></semantics></math> which is converted to Cartesian form in frame <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{i\}</annotation></semantics></math> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>i</mi></msup><msubsup><mi>ğ</mi><mi>j</mi><mi>â™¯</mi></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>r</mi><mi>â™¯</mi></msup><mo>cos</mo><msup><mi>Î²</mi><mi>â™¯</mi></msup><mo>,</mo><msup><mi>r</mi><mi>â™¯</mi></msup><mo>sin</mo><msup><mi>Î²</mi><mi>â™¯</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆˆ</mo><msup><mi>â„</mi><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> {^i}\bm{P}_j^\sharp = \left( r^\sharp
\cos{\beta^\sharp}, r^\sharp \sin{\beta^\sharp} \right) \in \mathbb{R}^2. </annotation></semantics></math></p></li>
<li><p>The estimated position of the landmark in frame <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{i\}</annotation></semantics></math> is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>i</mi></msup><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>âŠ–</mi><msup><mi></mi><mn>0</mn></msup><msub><mi>Î¾</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>â€¢</mo><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub><mo>âˆˆ</mo><msup><mi>â„</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
{^i}\hat{\bm{P}}_j = \left( \ominus {^0}\xi_i \right) \bullet \hat{\bm{P}}_j \in \mathbb{R}^2 </annotation></semantics></math> and the error vector is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğŸ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Îµ</mi><mo>=</mo><msup><mi></mi><mi>i</mi></msup><msub><mover><mi>ğ</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub><mo>âˆ’</mo><msup><mi></mi><mi>i</mi></msup><msubsup><mi>ğ</mi><mi>j</mi><mi>â™¯</mi></msubsup><mo>âˆˆ</mo><msup><mi>â„</mi><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> \bm{f}_k(\bm{x}) = \varepsilon = {^i}\hat{\bm{P}}_j -
{^i}\bm{P}_j^\sharp \in \mathbb{R}^2. </annotation></semantics></math></p></li>
</ul>
</div>
</section></section>
<section>
<section id="complementary-filter" class="title-slide slide level1 center">
<h1>Complementary Filter</h1>

</section>
<section id="complementary-filter-1" class="slide level2 smaller">
<h2>Complementary filter</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>They provide a means to fuse multiple independent noisy measurements of the same signal that have complementary spectral characteristics.
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¼</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\mu_1</annotation></semantics></math>: predominantly high frequency noise</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¼</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\mu_2</annotation></semantics></math>: predominantly low frequency disturbance</li>
</ul></li>
<li>Choose a pair of complementary transfer functions <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>F</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex"> F_1(s) + F_2(s) = 1 </annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_1(s)</annotation></semantics></math>: low-pass transfer function</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_2(s)</annotation></semantics></math>: high-pass transfer function</li>
</ul></li>
</ul>
</div><div class="column" style="width:30%;">
<center>
<img data-src="contents/assets/complementary1.png" width="100%">
</center>
<center>
<img data-src="contents/assets/complementary2.png" width="100%">
</center>
</div><ul>
<li><p>The filtered estimate is given by <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>X</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>F</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Y</mi><mn>2</mn></msub><mo>=</mo><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î¼</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>F</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î¼</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \hat{X}(s) = F_1(s)Y_1 + F_2(s)Y_2 = X(s) + F_1(s)\mu_1(s) + F_2(s)\mu_2(s).
</annotation></semantics></math></p></li>
<li><p>This type of filter is also known as <em>distorsionless filtering</em> since the signal <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x(t)</annotation></semantics></math> is not distorted by the filter.</p></li>
</ul>
</div>
</section>
<section id="complementary-filter-2" class="slide level2 smaller">
<h2>Complementary filter</h2>
<ul>
<li>Complementary filters are particularly well suited to fusing low bandwidth position measurements with high bandwidth rate measurements for first-order kinematic systems <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>x</mi><mo accent="true">Ì‡</mo></mover><mo>=</mo><mi>u</mi></mrow><annotation encoding="application/x-tex"> \dot{x} = u </annotation></semantics></math> with typical measurement characteristics <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>x</mi></msub><mo>=</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi><mo>+</mo><msub><mi>Î¼</mi><mi>x</mi></msub><mo>,</mo><mspace width="2.0em"></mspace><msub><mi>y</mi><mi>u</mi></msub><mo>=</mo><mi>u</mi><mo>+</mo><msub><mi>Î¼</mi><mi>u</mi></msub><mo>+</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> y_x = L(s)x + \mu_x, \qquad y_u = u + \mu_u + b(t) </annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(s)</annotation></semantics></math>: low-pass filter associated with sensor characteristics,</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¼</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>: noise in both measurements,</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b(t)</annotation></semantics></math> is a deterministic perturbation dominated by low-frequency content.</li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰ˆ</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L(s) \approx 1</annotation></semantics></math> over frequency range on which the measurement <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>x</mi></msub><annotation encoding="application/x-tex">y_x</annotation></semantics></math> is of interest.</li>
<li>The rate measurement is integrated: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msub><mi>y</mi><mi>u</mi></msub><mi>s</mi></mfrac><annotation encoding="application/x-tex">\frac{y_u}{s}</annotation></semantics></math> to obtain an estimate of the state and the noise and bias characteristics of the signal are dominantly low frequency effects.</li>
<li>Now, choose: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>s</mi></mrow></mfrac><mo>,</mo><mspace width="2.0em"></mspace><msub><mi>F</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>s</mi><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>s</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> F_1(s) = \frac{C(s)}{C(s) + s}, \qquad F_2(s) = 1 - F_1(s) = \frac{s}{C(s) +
s} </annotation></semantics></math>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C(s)</annotation></semantics></math>: all pass such that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰ˆ</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L(s)F_1(s) \approx 1</annotation></semantics></math> over the bandwidth of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(s)</annotation></semantics></math>. Then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>X</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰ˆ</mo><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î¼</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mrow><msub><mi>Î¼</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>s</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex"> \hat{X}(s) \approx X(s) + F_1(s)\mu_x(s) + \frac{\mu_u(s) + b(s)}{C(s) +
s}. </annotation></semantics></math></li>
</ul></li>
</ul>
</section>
<section id="complementary-filter-3" class="slide level2 smaller">
<h2>Complementary filter</h2>
<center>
<img data-src="contents/assets/blkdiag.png" width="50%">
</center>
<ul>
<li>The filter structure is implemented by exploiting the complementary sensitivity structure of a linear feedback system subject to load disturbance.</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>s</mi><mo>+</mo><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msub><mi>y</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mi>s</mi><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>s</mi></mrow></mfrac><mfrac><mrow><msub><mi>y</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>s</mi></mfrac><mo>=</mo><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>y</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><msub><mi>y</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>s</mi></mfrac></mrow><annotation encoding="application/x-tex"> \hat{x}(s) = \frac{C(s)}{s + C(s)} y_x(s) + \frac{s}{C(s) + s}
\frac{y_u(s)}{s} = T(s)y_x(s) + S(s)\frac{y_u(s)}{s} </annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(s)</annotation></semantics></math> is the sensitivity function of the closed-loop system and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T(s)</annotation></semantics></math> is the complementary sensitivity.</p>
<ul>
<li><p>Simplest choice for feedback: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>k</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">C(s) = k_p</annotation></semantics></math>. In this case, the CL-dynamics of the filter are given by <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover><mo accent="true">Ì‡</mo></mover><mo>=</mo><msub><mi>y</mi><mi>u</mi></msub><mo>+</mo><msub><mi>k</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>x</mi></msub><mo>âˆ’</mo><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \dot{\hat{x}} = y_u + k_p(y_x - \hat{x}). </annotation></semantics></math></p></li>
<li><p>Associated complementary filters associated with this choice are <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msub><mi>k</mi><mi>p</mi></msub><mrow><mi>s</mi><mo>+</mo><msub><mi>k</mi><mi>p</mi></msub></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mspace width="1.0em"></mspace><msub><mi>F</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>s</mi><mrow><mi>s</mi><mo>+</mo><msub><mi>k</mi><mi>p</mi></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">F_1(s) = \frac{k_p}{s+k_p}, \quad \text{ and } \quad  F_2(s) = \frac{s}{s + k_p}. </annotation></semantics></math></p></li>
</ul>
</section>
<section id="complementary-filter-4" class="slide level2 smaller">
<h2>Complementary filter</h2>
<ul>
<li><p>If the rate measurement bias, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">b(t) = b_0</annotation></semantics></math>, is a constant then it is natural to add an integrator to the compensator to make the system type I <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>k</mi><mi>p</mi></msub><mo>+</mo><mfrac><msub><mi>k</mi><mi>i</mi></msub><mi>s</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex"> C(s) = k_p + \frac{k_i}{s}. </annotation></semantics></math></p></li>
<li><p>A type I system will reject the constant load disturbance <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mn>0</mn></msub><annotation encoding="application/x-tex">b_0</annotation></semantics></math> from the output.</p></li>
<li><p>The resulting dynamics are <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover><mo accent="true">Ì‡</mo></mover><mo>=</mo><msub><mi>y</mi><mi>u</mi></msub><mo>âˆ’</mo><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover><mo>+</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>x</mi></msub><mo>âˆ’</mo><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="2.0em"></mspace><mover><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover><mo accent="true">Ì‡</mo></mover><mo>=</mo><mi>âˆ’</mi><msub><mi>k</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>x</mi></msub><mo>âˆ’</mo><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \dot{\hat{x}} = y_u - \hat{b} + k(y_x - \hat{x}), \qquad \dot{\hat{b}} =
-k_i(y_x - \hat{x}). </annotation></semantics></math></p></li>
<li><p>Consider the Lyapunov function candidate <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>â„’</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false" form="prefix">|</mo><mi>x</mi><mo>âˆ’</mo><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover><msup><mo stretchy="false" form="postfix">|</mo><mn>2</mn></msup><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msub><mi>k</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false" form="prefix">|</mo><msub><mi>b</mi><mn>0</mn></msub><mo>âˆ’</mo><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover><msup><mo stretchy="false" form="postfix">|</mo><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> \mathcal{L} = \frac{1}{2} \lvert x - \hat{x}\rvert^2 + \frac{1}{2k_i}\lvert b_0 - \hat{b} \rvert^2. </annotation></semantics></math></p>
<ul>
<li>Abusing the notation for the noise processes and using <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>x</mi><mo accent="true">Ìƒ</mo></mover><mo>=</mo><mi>x</mi><mo>âˆ’</mo><mover><mi>x</mi><mo accent="true">Ì‚</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{x} = x -
\hat{x}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>b</mi><mo accent="true">Ìƒ</mo></mover><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>âˆ’</mo><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{b} = b_0 - \hat{b}</annotation></semantics></math>, one has <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mtext mathvariant="normal">d</mtext><mrow><mtext mathvariant="normal">d</mtext><mi>t</mi></mrow></mfrac><mi>â„’</mi><mo>=</mo><mi>âˆ’</mi><msub><mi>k</mi><mi>p</mi></msub><mo stretchy="false" form="prefix">|</mo><mover><mi>x</mi><mo accent="true">Ìƒ</mo></mover><msup><mo stretchy="false" form="postfix">|</mo><mn>2</mn></msup><mo>âˆ’</mo><msub><mi>Î¼</mi><mi>u</mi></msub><mover><mi>x</mi><mo accent="true">Ìƒ</mo></mover><mo>+</mo><msub><mi>Î¼</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>b</mi><mo accent="true">Ìƒ</mo></mover><mo>âˆ’</mo><mi>k</mi><mover><mi>x</mi><mo accent="true">Ìƒ</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \frac{\text{d}}{\text{d}t} \mathcal{L} = -k_p \lvert \tilde{x} \rvert^2 -
\mu_u \tilde{x} + \mu_x \left( \tilde{b} - k \tilde{x} \right). </annotation></semantics></math></li>
</ul></li>
<li><p>In the absence of noise, one may apply Lyapunovâ€™s direct method to prove convergence of the state estimate.</p>
<ul>
<li>LaSalleâ€™s invariance principle may be used to show that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>b</mi><mo accent="true">Ì‚</mo></mover><mo>â†’</mo><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\hat{b} \rightarrow
b_0</annotation></semantics></math>.</li>
<li>When the underlying system is linear, the linear form of the feedback and adaptation law ensure that the CL system is linear and stability implies exponential stability.</li>
</ul></li>
</ul>
</section>
<section id="complementary-filter-on-bmso3" class="slide level2 smaller">
<h2>Complementary filter on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ğ’</mi><mi>ğ</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{SO}(3)</annotation></semantics></math></h2>
<p>&nbsp;</p>
<ul>
<li>Estimation of the roll and pitch angles from IMU using the complementary filter
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>-axis linear accelerometer</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>-axis gyro rates</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>-axis magnetometer</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p>&nbsp;</p>
<center>
<img data-src="contents/assets/complementary_so3.png" width="100%">
</center>
</div><div class="column" style="width:50%;">
<center>
<img data-src="contents/assets/roll_pitch.png" width="100%">
</center>
</div></div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Robotics and Automated Systems â€¢ Aykut C. Satici</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'pointer': {"key":"q","color":"#32cd32","pointerSize":18,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>